# Benchmark history


# 2024-01-06

Redesigned Express to not create a prototype chain on the req/res objects. The following are the benchmark results between the old version (Express 5 - with prototype chaining) with the new design.

**System Specs**

- Mac mini
- Apple M1
- Memory: 16 GB
- OS Version: 14.2.1 macOS Sonoma

## Old design (with prototype chain)

    autocannon -c 100 -d 5 -p 10 http://localhost:3333/?foo[bar]=baz

    Running 5s test @ http://localhost:3333/?foo[bar]=baz
    100 connections with 10 pipelining factor


    ┌─────────┬───────┬───────┬───────┬───────┬──────────┬──────────┬─────────┐
    │ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev    │ Max     │
    ├─────────┼───────┼───────┼───────┼───────┼──────────┼──────────┼─────────┤
    │ Latency │ 16 ms │ 29 ms │ 66 ms │ 70 ms │ 38.63 ms │ 61.67 ms │ 1562 ms │
    └─────────┴───────┴───────┴───────┴───────┴──────────┴──────────┴─────────┘
    ┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬──────────┬─────────┐
    │ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev    │ Min     │
    ├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
    │ Req/Sec   │ 22,351  │ 22,351  │ 26,143  │ 26,543  │ 25,460.8 │ 1,568.25 │ 22,336  │
    ├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
    │ Bytes/Sec │ 5.32 MB │ 5.32 MB │ 6.22 MB │ 6.32 MB │ 6.06 MB  │ 375 kB   │ 5.32 MB │
    └───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴──────────┴─────────┘

    Req/Bytes counts sampled once per second.
    # of samples: 5

    128k requests in 5.02s, 30.3 MB read

## New design

    autocannon -c 100 -d 5 -p 10 http://localhost:3333/?foo[bar]=baz

    Running 5s test @ http://localhost:3333/?foo[bar]=baz
    100 connections with 10 pipelining factor


    ┌─────────┬──────┬───────┬───────┬───────┬──────────┬──────────┬────────┐
    │ Stat    │ 2.5% │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev    │ Max    │
    ├─────────┼──────┼───────┼───────┼───────┼──────────┼──────────┼────────┤
    │ Latency │ 9 ms │ 16 ms │ 22 ms │ 26 ms │ 16.32 ms │ 11.46 ms │ 471 ms │
    └─────────┴──────┴───────┴───────┴───────┴──────────┴──────────┴────────┘
    ┌───────────┬─────────┬─────────┬─────────┬─────────┬──────────┬──────────┬─────────┐
    │ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg      │ Stdev    │ Min     │
    ├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
    │ Req/Sec   │ 54,943  │ 54,943  │ 60,575  │ 60,703  │ 59,363.2 │ 2,230.44 │ 54,922  │
    ├───────────┼─────────┼─────────┼─────────┼─────────┼──────────┼──────────┼─────────┤
    │ Bytes/Sec │ 13.1 MB │ 13.1 MB │ 14.4 MB │ 14.4 MB │ 14.1 MB  │ 531 kB   │ 13.1 MB │
    └───────────┴─────────┴─────────┴─────────┴─────────┴──────────┴──────────┴─────────┘

    Req/Bytes counts sampled once per second.
    # of samples: 5

    298k requests in 5.02s, 70.6 MB read

# Results

## Version 3 - 1/6/2024, 6:51:42 PM

| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 7 ms | 18 ms | 21 ms | 26 ms | 15.23 ms | 17.1 ms | 600 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 56,255 | 56,255 | 64,511 | 66,495 | 63,388.8 | 3,687.84 | 56,241 |
| Bytes/Sec | 13.4 MB | 13.4 MB | 15.4 MB | 15.8 MB | 15.1 MB | 877 kB | 13.4 MB |

## Version 3 - 1/6/2024, 7:19:01 PM

| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 8 ms | 18 ms | 20 ms | 22 ms | 15.4 ms | 18.39 ms | 667 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 52,095 | 52,095 | 65,439 | 65,855 | 62,758.4 | 5,344.96 | 52,088 |
| Bytes/Sec | 12.4 MB | 12.4 MB | 15.6 MB | 15.7 MB | 14.9 MB | 1.27 MB | 12.4 MB |

## 01/20/2024, 02:15:46 PM
    Application Version: 4.0.0
    Node Version: v18.18.2
    Number of Middelware: 1


| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 9 ms | 20 ms | 25 ms | 34 ms | 16.86 ms | 6 ms | 68 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 54,431 | 54,431 | 58,207 | 59,327 | 57,520 | 1,687.71 | 54,403 |
| Bytes/Sec | 13 MB | 13 MB | 13.9 MB | 14.1 MB | 13.7 MB | 403 kB | 12.9 MB |

## 01/20/2024, 02:16:19 PM
    Application Version: 4.0.0
    Node Version: v19.9.0
    Number of Middelware: 1


| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 9 ms | 18 ms | 21 ms | 25 ms | 15.43 ms | 5.36 ms | 67 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 58,303 | 58,303 | 64,127 | 64,799 | 62,793.6 | 2,397.86 | 58,275 |
| Bytes/Sec | 13.9 MB | 13.9 MB | 15.3 MB | 15.4 MB | 14.9 MB | 570 kB | 13.9 MB |

## 01/20/2024, 02:16:34 PM
    Application Version: 4.0.0
    Node Version: v20.10.0
    Number of Middelware: 1


| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 7 ms | 18 ms | 20 ms | 25 ms | 15.18 ms | 14.64 ms | 522 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 61,183 | 61,183 | 64,351 | 65,983 | 63,635.2 | 1,807.61 | 61,165 |
| Bytes/Sec | 14.6 MB | 14.6 MB | 15.3 MB | 15.7 MB | 15.1 MB | 429 kB | 14.6 MB |

## 01/20/2024, 02:17:00 PM
    Application Version: 4.0.0
    Node Version: v21.5.0
    Number of Middelware: 1


| Stat | 2.5% | 50% | 97.5% | 99% | Avg | Stdev | Max |
|:-----|:----:|:---:|:-----:|:---:|:---:|:-----:|:---:|
| Latency | 8 ms | 17 ms | 19 ms | 21 ms | 14.27 ms | 16.27 ms | 590 ms |

| Stat | 1% | 2.5% | 50% | 97.5% | Avg | Stdev | Min |
|:-----|:--:|:----:|:---:|:-----:|:---:|:-----:|:---:|
| Req/Sec | 58,751 | 58,751 | 69,951 | 70,911 | 67,593.61 | 4,583.76 | 58,720 |
| Bytes/Sec | 14 MB | 14 MB | 16.6 MB | 16.9 MB | 16.1 MB | 1.09 MB | 14 MB |

